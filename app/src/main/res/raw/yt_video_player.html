<!DOCTYPE html>
<html lang="en">
    <head>
        <style>
            html, body {
                margin: 0;
                padding: 0;
                pointer-events:none;
            }

            .container {
                position: fixed;
                width: 100%;
                height: 100%;
                z-index: 100;
            }

            .youtube-container {
                overflow: hidden;
                width: 100%;
                /* Keep it the right aspect-ratio */
                aspect-ratio: 16/9;
                /* No clicking/hover effects */
                pointer-events: none;

                iframe {
                    /* Extend it beyond the viewport... */
                    width: 300%;
                    height: 100%;
                    /* ...and bring it back again */
                    margin-left: -100%;
                }
            }
        </style>
        <title>Zene Video Player</title>
    </head>
    <body>
        <div class="container">
            <div id="player"></div>
        </div>
        <script>
            var setDuration = 0;
            var setSpeed = 1.0;

            async function setLocalStorageItem() {
              const currentTimestamp = Date.now();
              const threeMinutesBefore = currentTimestamp - 3 * 60 * 1000;
              const oneYearAfter = threeMinutesBefore + 365 * 24 * 60 * 60 * 1000;

              try {
                const value = JSON.stringify({
                  data: '{"quality":<<Quality>>,"previousQuality":<<Quality>>}',
                  expiration: oneYearAfter,
                  creation: threeMinutesBefore,
                });
                await new Promise((resolve) => setTimeout(resolve, 100));
                localStorage.setItem("yt-player-quality", value);
              } catch (error) {
                console.error("Error setting LocalStorage item:", error);
              }
            }

            document.addEventListener("DOMContentLoaded", (event) => {
              setLocalStorageItem();
            });


            var tag = document.createElement("script");

            tag.src = "https://www.youtube.com/iframe_api";
            var firstScriptTag = document.getElementsByTagName("script")[0];
            firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

            var player;
            function onYouTubeIframeAPIReady() {
              player = new YT.Player("player", {
                height: "100%",
                width: "100%",
                videoId: "<<VideoID>>",
                playerVars: { 'autoplay': 1, 'controls': 0, 'iv_load_policy': 3, 'disablekb': 1, 'fs': 0, 'loop': 1, 'modestbranding': 1, 'rel': 0, 'showinfo': 0, 'mute': 1, 'autohide': 1 },
                events: {
                  onReady: onPlayerReady,
                  onStateChange: onPlayerStateChange,
                },
              });
            }

            function onPlayerReady(event) {
              event.target.unMute();
              event.target.setVolume(100);
              event.target.setLoop(true);
              event.target.playVideo();
              event.target.seekTo(setDuration);
              event.target.setPlaybackRate(setSpeed);

              Zene.videoInfo(player.getVideoData().title, player.getVideoData().author);
            }

            function playingStatus() {
              Zene.videoState(player.getPlayerState(), player.getCurrentTime(), player.getDuration(), player.isMuted());
            }

            function onPlayerStateChange(event) {
              playingStatus();
              if (event.data === YT.PlayerState.ENDED) player.loadVideoById("<<VideoID>>");
            }

            function unMute() {
               player.unMute();
               playingStatus();
            }

            function mute() {
               player.mute();
               playingStatus();
            }

            function playbackRate(v) {
               player.setPlaybackRate(v);
            }

            function seekTo(v) {
              player.seekTo(v);
              playingStatus();
            }

            function seekAhead() {
              seekTo(player.getCurrentTime() + 10);
            }

            function seekBack() {
              seekTo(player.getCurrentTime() - 10);
            }

            function playVideo() {
              player.playVideo();
            }

            function pauseVideo() {
              player.pauseVideo();
            }

            function stopVideo() {
              player.stopVideo();
            }

        </script>
    </body>
</html>
