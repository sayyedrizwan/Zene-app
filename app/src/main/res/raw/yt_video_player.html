<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Zene Video</title>
        <style>
            * {
              padding: 0;
              margin: 0;
            }

            .player {
              position: fixed;
              left: 0;
              bottom: 0;
              width: 100%;
              height: 100%;
            }
            .youtube-container iframe {
                overflow: hidden;
                width: 100%;
                aspect-ratio: 16/9;
                pointer-events: none;
            }

            .youtube-container iframe {
                width: 300%;
                height: 100%;
                margin-left: -100%;
            }
        </style>
    </head>

    <body>
        <div class="youtube-container">
            <div id="player" class="player"></div>
        </div>

        <script>
            async function setLocalStorageItem() {
              const currentTimestamp = Date.now();
              const threeMinutesBefore = currentTimestamp - 3 * 60 * 1000;
              const oneYearAfter = threeMinutesBefore + 365 * 24 * 60 * 60 * 1000;

              try {
                const value = JSON.stringify({
                  data: '{"quality":<<Quality>>,"previousQuality":<<Quality>>}',
                  expiration: oneYearAfter,
                  creation: threeMinutesBefore,
                });
                await new Promise((resolve) => setTimeout(resolve, 100));
                localStorage.setItem("yt-player-quality", value);
              } catch (error) {
                console.error("Error setting LocalStorage item:", error);
              }
            }

            document.addEventListener("DOMContentLoaded", (event) => {
              setLocalStorageItem();
            });

            var tag = document.createElement("script");

            tag.src = "https://www.youtube.com/iframe_api";
            var firstScriptTag = document.getElementsByTagName("script")[0];
            firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

            var player;
            function onYouTubeIframeAPIReady() {
              player = new YT.Player("player", {
                videoId: "<<VideoID>>",
                playerVars: {
                  autoplay: 1,
                  playsinline: 1,
                  mute: 0,
                  controls: 0,
                  showinfo: 0,
                  modestbranding: 1,
                  loop: 1,
                  fs: 0,
                  enablejsapi: 1,
                  playlist: ["<<VideoID>>"],
                  rel: 0,
                },
                events: {
                  onReady: onPlayerReady,
                  onStateChange: onPlayerStateChange,
                },
              });
            }

            function onPlayerReady(event) {
              setTimeout(() => {
                event.target.setVolume(100);
                event.target.unMute();
              }, 1000);
            }

            function onPlayerStateChange(event) {
              if (event.data == YT.PlayerState.PLAYING) {
                 Video.playerState()
                 var tracks = player.getOption('captions', 'tracklist');
                    if (tracks && tracks.length > 0) {
                       Video.captionAvailable(true)
                    } else {
                       Video.captionAvailable(false)
                    }
              }
            }

            function playerStatus() {
                Video.playerState(player.getPlayerState(), player.getDuration(), player.getCurrentTime());
            }


            function pauseSong() {
              player.pauseVideo();
            }

            function playSong() {
              player.setVolume(100);
              player.playVideo();
            }

            function seekTo(time) {
              player.seekTo(time, true);
            }

            function enableCaption() {
              try {
                  player.loadModule("captions");
                  player.loadModule("cc");
              } catch (exception) { }
            }

            function disableCaption() {
              try {
                  player.unloadModule("captions");
                  player.unloadModule("cc");
              } catch (exception) { }
            }

            function playbackSpeed(speed) {
              player.setPlaybackRate(speed);
              playerState(player, false);
            }
        </script>
    </body>
</html>
